{"version":3,"file":"scatter.js","sources":["../scatterplot.js","../scatter.js"],"sourcesContent":["// Mouseover line adapted from here\n// https://bl.ocks.org/larsenmtl/e3b8b7c2ca4787f77d78f58d41c3da91\n\nimport { \n  select, \n  scaleTime, \n  scaleLinear, \n  extent,\n  axisLeft,\n  axisBottom,\n  format,\n  nest,\n  line,\n  curveBasis,\n  mouse\n} from 'd3';\n\nexport const scatterplot = (selection, props) => {\n  const {\n    data,\n    colorScale,\n    colorValue,\n    selectedArtist,\n    innerWidth,\n    innerHeight,\n    circleRadius\n  } = props;\n  \n  console.log(data); \n \n  const xValue = d => new Date(d.year);\n  const xAxisLabel = 'year';\n \n  const yValue = d => d.price;\n  const yAxisLabel = 'price';\n  \n\t// const tooltipMargin = { left: 0, bottom: 0, right: 0, top: 0 };\n //  const tooltipLineMargin = 10;\n //  const tooltipWidth = 150;\n  \n  const gUpdate = selection.selectAll('g').data([null]);\n  const gEnter = gUpdate.enter().append('g');\n  const g = gUpdate.merge(gEnter);\n  \n  const xScale = scaleTime()\n    .domain(extent(data, xValue))\n    .range([0, innerWidth])\n    //.nice(); \n    \n  const yScale = scaleLinear()\n    .domain(extent(data, yValue))\n    .range([innerHeight, 0])\n    .nice();\n\n  const xAxis = axisBottom(xScale)\n    // .ticks(26)\n    // .tickSize(-innerHeight)\n    // .tickPadding(15);\n  \n  const xAxisG = gEnter\n  \t.append('g').call(xAxis)\n    .attr('transform', `translate(0,${innerHeight})`);\n  \n  // xAxisG.select('.domain').remove();\n  \n  // xAxisG.append('text')\n  //   .attr('class', 'axis-label')\n  //   .attr('y', 50)\n  //   .attr('x', innerWidth / 2)\n  //   .attr('fill', 'black')\n  //   .text(xAxisLabel);\n\n  // const yAxisTickFormat = number =>\n  //   format('.2s')(number)\n  //     .replace('.0', '');\n  \n  const yAxis = axisLeft(yScale)\n    // .tickSize(-innerWidth)\n    // .tickPadding(5)\n    // .tickFormat(yAxisTickFormat);\n  \n  const yAxisG = gEnter\n  \t.append('g').call(yAxis);\n  \n  // yAxisG.selectAll('.domain').remove();\n  \n  // yAxisG.append('text')\n  //   .attr('class', 'axis-label')\n  //   .attr('y', -35)\n  //   .attr('x', -innerHeight / 2)\n  //   .attr('fill', 'black')\n  //   .attr('transform', `rotate(-90)`)\n  //   .attr('text-anchor', 'middle')\n  //   .text(yAxisLabel);\n\n  // var legendOrdinal = d3.legendColor()\n  // //d3 symbol creates a path-string, for example\n  // //\"M0,-8.059274488676564L9.306048591020996,\n  // //8.059274488676564 -9.306048591020996,8.059274488676564Z\"\n  // .shape(\"path\", d3.symbol().type(d3.symbolTriangle).size(150)())\n  // .shapePadding(10)\n  // //use cellFilter to hide the \"e\" cell\n  // // .cellFilter(function(d){ return d.label !== \"e\" })\n  // .scale(colorScale)\n  // // .on('cellclick', cell => {\n  // //   if (filtered.includes(cell)) {\n  // //     filtered = filtered.filter(c => c != cell)\n  // //   }\n  // //   else {\n  // //     filtered.push(cell)\n  // //   }\n  // //   console.log(filtered)\n  // // });\n\n  // d3.select(\".legendOrdinal\")\n  //   .call(legendOrdinal);\n\n    // const lines = selection.selectAll('.line-path').data(nested);\n    // const linesEnter = lines.enter().append('path')\n    //     .attr('class', 'line-path')\n    //     .attr('stroke', d => colorScale(d.key));\n        \n    // lines.merge(linesEnter)\n    //   .transition()\n    //     .duration(200)\n    //     .attr('d', d => lineGenerator(d.values))\n    //     .attr('stroke-width', d => (!selectedArtist || d.key === selectedArtist) ? 1 : 0);\n    \n    var dots = selection.selectAll('dot').data(data)\n    var dotsEnter = dots.enter().append(\"circle\")\n      .attr(\"cx\", function (d) { return xScale(d.year); } )\n      .attr(\"cy\", function (d) { return yScale(d.price); } )\n      .attr(\"r\", circleRadius)\n      .style(\"fill\", d => colorScale(d.model))\n\n    dots.merge(dotsEnter)\n      // .attr('opacity', d => console.log(filtered.includes(d)))\n\n    // Add dots\n    // svg.append('g')\n    //   .selectAll(\"dot\")\n    //   .data(data)\n    //   .enter()\n    //   .append(\"circle\")\n    //     .attr(\"cx\", function (d) { return x(new Date(d.year)); } )\n    //     .attr(\"cy\", function (d) { return y(d.price); } )\n    //     .attr(\"r\", 1.5)\n    //     .style(\"fill\", d => modelScale(d.model))\n\n  // })\n   // const lineGenerator = line()\n   //  .x(d => xScale(xValue(d)))\n   //  .y(d => yScale(yValue(d)))\n   //  .curve(curveBasis);\n  \n\n  // const nested = nest()\n  //   .key(d => d.genre)\n  //   .entries(data);\n  \n    \n  // const lines = selection.selectAll('.line-path').data(nested);\n  // const linesEnter = lines.enter().append('path')\n  //     .attr('class', 'line-path')\n  //     .attr('stroke', d => colorScale(d.key));\n    \t\n  // lines.merge(linesEnter)\n  // \t.transition()\n  //   \t.duration(200)\n  //   \t.attr('d', d => lineGenerator(d.values))\n  //   \t.attr('stroke-width', d => (!selectedArtist || d.key === selectedArtist) ? 1 : 0);\n  \n  \n};\n","import {\n  select,\n  csv,\n  scaleLinear,\n  scaleTime,\n  extent,\n  axisLeft,\n  axisBottom,\n  scaleOrdinal,\n  schemeCategory10,\n  format\n} from 'd3';\n// import { colorLegend } from './colorLegend';\n// import { loadData } from './loadData';\nimport { scatterplot } from './scatterplot';\n\nconst colorScale = scaleOrdinal();\n// var modelScale = d3.scaleOrdinal()\n  \n\nconst colorValue = d => d.model;\n// var genres;\nvar selectedArtist;\nvar data;\nconst width = window.innerWidth;\nconst height = window.innerHeight/2\nconst svg = select('#dashboard').append('svg')\n  .attr('width', width)\n  .attr('height', height)\n\n\n// const width = +svg.attr('width');\n// const height = +svg.attr('height');\nconst margin = { top: 10, right: 10, bottom: 30, left: 40 };\nconst innerWidth = width - margin.left - margin.right;\nconst innerHeight = height - margin.top - margin.bottom;\n// const title = 'Porsches';\n\nconst scatterG = svg.append('g')\n  .attr('transform', `translate(${margin.left},${margin.top})`);\nconst colorLegendG = svg.append('g')\n  .attr('transform', `translate(20, 10)`);\n\n// svg.append('text')\n//   .attr('class', 'title')\n//   .attr('x', (width + margin.left) / 2)\n//   .attr('y', 45)\n//   .text(title);\n\nd3.json('/cars/porsche/data/download').then(porscheData => {\n  console.log(data)\n  // data = processedData.weekData;\n  // genres = processedData.sortedGenres;\n  data = porscheData\n  render();\n});\n\nconst onClick = d => {\n  selectedArtist = d;\n  render(); \n};\n\nconst render = () => {\n  colorScale\n    .domain(['911', 'Cayman'])\n    .range(schemeCategory10)\n  \n  // colorLegendG.call(colorLegend, {\n  //   colorScale,\n  //   circleRadius: 7,\n  //   spacing: 15,\n  //   textOffset: 12,\n  //   backgroundRectWidth: 135,\n  //   onClick,\n  //   selectedArtist\n  // });\n  \n  \n  scatterG.call(scatterplot, {\n    data,\n    colorScale,\n    colorValue,\n    selectedArtist,\n    innerWidth,\n    innerHeight,\n    circleRadius: 3\n  });\n  \n};\n// import 'd3'\n\n//     var filtered = []\n   \n//     var margin = {top: 10, right: 60, bottom: 30, left: 60},\n//       width = window.innerWidth - margin.left - margin.right,\n//       height = (window.innerHeight/2) - margin.top - margin.bottom;\n\n//     // append the svg object to the body of the page\n//     var svg = d3.select(\"#dashboard\")\n//       .append(\"svg\")\n//         .attr(\"width\", width + margin.left + margin.right)\n//         .attr(\"height\", height + margin.top + margin.bottom)\n//       .append(\"g\")\n//         .attr(\"transform\",\n//           \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n//     svg.append('g')\n//         .attr('class', 'legendOrdinal')\n//         .attr('transform', `translate(20, 20)`)\n\n//     //Read the data\n//     d3.json(\"/cars/porsche/data/download\").then(data => {\n//       // fullData = data\n//       // Add X axis\n//       var x = d3.scaleTime()\n//         // .domain([2004, 2012])\n//         .domain([new Date(2004, 0, 1), new Date(2012, 0, 1)])\n\n//         .range([ 0, width ]);\n//       svg.append(\"g\")\n//         .attr(\"transform\", \"translate(0,\" + height + \")\")\n//         .call(d3.axisBottom(x));\n\n//       // Add Y axis\n//       var y = d3.scaleLinear()\n//         .domain([0, 150000])\n//         .range([ height, 0]);\n//       svg.append(\"g\")\n//         .call(d3.axisLeft(y));\n\n//       var modelScale = d3.scaleOrdinal()\n//         .domain(['911', 'Cayman'])\n//         .range([\"rgb(56, 106, 197)\", \"rgb(223, 199, 31)\"])\n\n//       var legendOrdinal = d3.legendColor()\n//         //d3 symbol creates a path-string, for example\n//         //\"M0,-8.059274488676564L9.306048591020996,\n//         //8.059274488676564 -9.306048591020996,8.059274488676564Z\"\n//         .shape(\"path\", d3.symbol().type(d3.symbolTriangle).size(150)())\n//         .shapePadding(10)\n//         //use cellFilter to hide the \"e\" cell\n//         // .cellFilter(function(d){ return d.label !== \"e\" })\n//         .scale(modelScale)\n//         .on('cellclick', cell => {\n//           if (filtered.includes(cell)) {\n//             filtered = filtered.filter(c => c != cell)\n//           }\n//           else {\n//             filtered.push(cell)\n//           }\n//           console.log(filtered)\n//         });\n\n//       d3.select(\".legendOrdinal\")\n//         .call(legendOrdinal);\n\n//       // const lines = selection.selectAll('.line-path').data(nested);\n//       // const linesEnter = lines.enter().append('path')\n//       //     .attr('class', 'line-path')\n//       //     .attr('stroke', d => colorScale(d.key));\n          \n//       // lines.merge(linesEnter)\n//       //   .transition()\n//       //     .duration(200)\n//       //     .attr('d', d => lineGenerator(d.values))\n//       //     .attr('stroke-width', d => (!selectedArtist || d.key === selectedArtist) ? 1 : 0);\n      \n//       var dots = svg.selectAll('dot').data(data)\n//       var dotsEnter = dots.enter().append(\"circle\")\n//         .attr(\"cx\", function (d) { return x(new Date(d.year)); } )\n//         .attr(\"cy\", function (d) { return y(d.price); } )\n//         .attr(\"r\", 1.5)\n//         .style(\"fill\", d => modelScale(d.model))\n\n//       dots.merge(dotsEnter)\n//         .attr('opacity', d => console.log(filtered.includes(d)))\n\n//       // Add dots\n//       // svg.append('g')\n//       //   .selectAll(\"dot\")\n//       //   .data(data)\n//       //   .enter()\n//       //   .append(\"circle\")\n//       //     .attr(\"cx\", function (d) { return x(new Date(d.year)); } )\n//       //     .attr(\"cy\", function (d) { return y(d.price); } )\n//       //     .attr(\"r\", 1.5)\n//       //     .style(\"fill\", d => modelScale(d.model))\n\n//     })"],"names":["scaleTime","extent","scaleLinear","axisBottom","axisLeft","scaleOrdinal","select","schemeCategory10"],"mappings":"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K,EAAE,QAAQ,CAAC,CAAC;EAC9B,KAAK,KAAK,CAACC,qBAAgB,EAAC;EAC5B;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,EAAE,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE;EAC7B,IAAI,IAAI;EACR,IAAI,UAAU;EACd,IAAI,UAAU;EACd,IAAI,cAAc;EAClB,IAAI,UAAU;EACd,IAAI,WAAW;EACf,IAAI,YAAY,EAAE,CAAC;EACnB,GAAG,CAAC,CAAC;EACL;EACA,CAAC,CAAC;EACF;;EAEA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;;;;"}